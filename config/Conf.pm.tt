package Conf;

use Config::Tiny;

$m5nr_name    = "[% m5nr_name %]";
$m5nr_collect = $m5nr_name."_[% m5nr_version %]";
$m5nr_solr    = "[% m5nr_solr %]";
$m5nr_fasta   = "[% m5nr_fasta %]";
$api_resource_dir  = "resources";
$api_resource_path = "[% api_dir %]/".$api_resource_dir;

if (-s $ENV{"KB_TOP"}.'/deployment.cfg') {
    $kb_cfg = Config::Tiny->read($ENV{"KB_TOP"}.'/deployment.cfg');
    if ($kb_cfg && exists($kb_cfg->{$m5nr_name})) {
        $m5nr_cfg = $kb_cfg->{$m5nr_name};
        if (exists($m5nr_cfg->{'M5NR_VERSION'})) {
            $m5nr_collect = $m5nr_name."_".$m5nr_cfg->{'M5NR_VERSION'};
        }
        if (exists($m5nr_cfg->{'SOLR_PORT'}) && exists($m5nr_cfg->{'SOLR_HOST'})) {
            $m5nr_solr = $m5nr_cfg->{'SOLR_PORT'}.':'.$m5nr_cfg->{'SOLR_HOST'}.'/solr';
        }
        if (exists($m5nr_cfg->{'SOLR_STORE'}) && exists($m5nr_cfg->{'M5NR_VERSION'})) {
            $m5nr_fasta = $m5nr_cfg->{'SOLR_STORE'}."_".$m5nr_cfg->{'M5NR_VERSION'}.'/md5nr';
        }
    }
}

1;
